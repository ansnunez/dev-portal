<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Network Layer · Zilliqa Developer Portal</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## Gossip Protocol"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Network Layer · Zilliqa Developer Portal"/><meta property="og:type" content="website"/><meta property="og:url" content="https://ansnunez.github.io/dev-portal/"/><meta property="og:description" content="## Gossip Protocol"/><meta property="og:image" content="https://ansnunez.github.io/dev-portal/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://ansnunez.github.io/dev-portal/img/docusaurus.png"/><link rel="shortcut icon" href="/dev-portal/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/dev-portal/js/scrollSpy.js"></script><link rel="stylesheet" href="/dev-portal/css/main.css"/><script src="/dev-portal/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/dev-portal/en"><img class="logo" src="/dev-portal/img/zilliqa-logo_1zilliqa-logo.png" alt="Zilliqa Developer Portal"/><h2 class="headerTitleWithLogo">Zilliqa Developer Portal</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/dev-portal/docs/en/basics-intro-blockchain" target="_self">Basics</a></li><li class=""><a href="/dev-portal/docs/en/dev-started-introduction" target="_self">Developers</a></li><li class=""><a href="/dev-portal/docs/en/mining-general-info" target="_self">Miners</a></li><li class=""><a href="/dev-portal/docs/en/staking-getting-started" target="_self">Exchanges</a></li><li class="siteNavGroupActive"><a href="/dev-portal/docs/en/contribute-buildzil" target="_self">Contributors</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/dev-portal/img/language.svg" alt="Languages icon"/>English</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/dev-portal/docs/zh-CN/core-network">中文</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Core Protocol Design</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Contributors</h3><ul class=""><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Contribution Guide</h4><ul><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/contribute-buildzil">Building Zilliqa</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/contribute-guidelines">Contribution Guidelines</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/contribute-bug-bounty">Bug Bounty Program</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Core Protocol Design</h4><ul><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-node-operation">General Node Operation</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-consensus">Consensus Layer</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/dev-portal/docs/en/core-network">Network Layer</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-messaging">Messaging Layer</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-data">Data Layer</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-directory-service">Directory Service</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-lookup">Lookup</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-mining">Mining</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-tools">Tools</a></li></ul></div></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Network Layer</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="gossip-protocol"></a><a href="#gossip-protocol" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Gossip Protocol</h2>
<p>A <code>RumorManager</code> library is available in the Zilliqa core to support message gossiping between nodes.</p>
<h3><a class="anchor" aria-hidden="true" id="overview"></a><a href="#overview" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Overview</h3>
<ul>
<li>The goal is to provide an alternative communication method to broadcasting, particularly in large-scale clusters.</li>
<li>The broadcasting implemented in <code>P2PComm::SendBroadcastMessage</code> is resource-hungry; it sends <code>O(n^2)</code> messages, requires a lot of threads, and opens too many TCP connections.</li>
<li>The gossip algorithm, described in detail in this <a href="https://zoo.cs.yale.edu/classes/cs426/2013/bib/karp00randomized.pdf">paper</a>, provides a method to spread a message in <code>O(logn)</code> rounds and <code>O(ln(ln(n)))</code> rumor messages (where <code>n</code> is the number of peers participating in the gossip).</li>
<li><code>RumorManager</code> plays the role of managing all the gossips/rumors and their states.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="interfaces"></a><a href="#interfaces" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Interfaces</h3>
<p>The following interfaces are exposed for a node to enable gossiping messages in the network.</p>
<h4><a class="anchor" aria-hidden="true" id="initializerumormanager"></a><a href="#initializerumormanager" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>InitializeRumorManager</h4>
<p>Every node in the network intializes <code>RumorManager</code> with the list of peers from their own shard or committee at the start of a new DS epoch (or after a successful view change).</p>
<p>Initialization involves the following:</p>
<ul>
<li>Storing peer list</li>
<li>Storing public keys of the peers in the peer list, the DS committee members, and lookup nodes</li>
<li>Storing the node's own peer information and key pair</li>
<li>Starting of rounds (that runs a loop every <code>ROUND_TIME_IN_MS</code> ms), which includes:
<ul>
<li>Checking the state of every rumor in <code>RumorHolder</code> and sending to <code>MAX_NEIGHBORS_PER_ROUND</code> random peers (if the rumor is not old enough).</li>
<li><code>RumorHolder</code> monitors/changes the state of each rumor it holds using the Median Counter algorithm (as explained in Section 3 of the whitepaper) for every round.</li>
</ul></li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="spreadrumor"></a><a href="#spreadrumor" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SpreadRumor</h4>
<p>This enables the node to initiate the rumor to be gossiped with its peer list. It will basically add the rumor to <code>RumorHolder</code>, which in turn manages its states and further gossiping.</p>
<h4><a class="anchor" aria-hidden="true" id="spreadforeignrumor"></a><a href="#spreadforeignrumor" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SpreadForeignRumor</h4>
<p>This enables the node to initiate spreading of the rumor received from a node that is not part of its peer list (hence, &quot;foreign&quot;). It verifies the sender node against all the public keys stored during the initialization of <code>RumorManager</code>.</p>
<h4><a class="anchor" aria-hidden="true" id="stoprounds"></a><a href="#stoprounds" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>StopRounds</h4>
<p>Stops the gossip round, thereby stopping the gossiping of rumors to peers.</p>
<h3><a class="anchor" aria-hidden="true" id="rumor-state-machine"></a><a href="#rumor-state-machine" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Rumor State Machine</h3>
<p>The rumor state machine is managed by <code>RumorHolder</code>.</p>
<p>Every rumor will be in one of following states at any time:</p>
<ul>
<li><code>NEW</code>: The peer <code>v</code> knows <code>r</code> and <code>counter(v,r) = m</code> (age/round)</li>
<li><code>KNOWN</code>: Cooling state; stay in this state for <code>m_maxRounds</code> rounds, and participate in rumor spreading</li>
<li><code>OLD</code>: Final state; member stops participating in rumor spreading</li>
</ul>
<p>Every rumor starts in the <code>NEW</code> state. It either stays in this state, or moves on to <code>KNOWN</code> or <code>OLD</code> state immediately or in successive rounds based on the algorithm mentioned in the whitepaper. Every rumor is tied up with the round (consider it as the rumor age).</p>
<p>A rumor is configured to stay in <code>NEW</code> and <code>KNOWN</code> state for a maximum of <code>&lt;MAX_ROUNDS_IN_BSTATE&gt;</code> and <code>&lt;MAX_ROUNDS_IN_CSTATE&gt;</code>, respectively.
The total rounds is configured to not exceed <code>&lt;MAX_TOTAL_ROUNDS&gt;</code>, after which the rumor is marked as <code>OLD</code>. These settings are found in the node's constants file, like thus:</p>
<pre><code class="hljs css language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">gossip_custom_rounds</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">MAX_ROUNDS_IN_BSTATE</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">MAX_ROUNDS_IN_BSTATE</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">MAX_ROUNDS_IN_CSTATE</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">MAX_ROUNDS_IN_CSTATE</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">MAX_TOTAL_ROUNDS</span>&gt;</span>6<span class="hljs-tag">&lt;/<span class="hljs-name">MAX_TOTAL_ROUNDS</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">gossip_custom_rounds</span>&gt;</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="gossip-message-format"></a><a href="#gossip-message-format" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Gossip Message Format</h3>
<table>
<thead>
<tr><th>START_BYTE_GOSSIP (0x33)</th><th>HDR</th><th>GOSSIP_MSGTYPE</th><th>GOSSIP_ROUND</th><th>GOSSIP_SNDR_PORT</th><th>PUB_KEY_SIZE</th><th>SIGNATURE</th><th>Payload Message</th></tr>
</thead>
<tbody>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="optimized-pull-push-mechanism"></a><a href="#optimized-pull-push-mechanism" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Optimized Pull-Push Mechanism</h3>
<p><code>GOSSIP_MSGTYPE</code> can refer to any of the following:</p>
<ul>
<li><code>PUSH (0x01)</code>: The response to a <code>PULL</code> request. The payload contains the raw message. It is sent out to the requesting peer.</li>
<li><code>PULL (0x02)</code>: The request for the raw message for a given hash. The payload contains the hash. It is sent out in response to the node who sent <code>LAZY_PUSH</code> or <code>LAZY_PULL</code>.</li>
<li><code>EMPTY_PUSH (0x03)</code>: This is sent out at every round to random neighbors if the node does not have any active rumors in its store. It indicates asking for any rumors from the node's neighbors. The payload contains unused dummy data.</li>
<li><code>EMPTY_PULL (0x04)</code>: This is sent out to the sender of <code>EMPTY_PULL</code> or <code>LAZY_PULL</code> to indicate that it doesn't have any active rumors either. The payload contains unused dummy data.</li>
<li><code>FORWARD (0x05)</code>: A special type that indicates that the message being sent out is from a foreign peer. This means the sender does not belong to the current shard or committee. Normally it is sent from a lookup to a shard or DS committee node, or between a shard node and DS committee node (in either direction).</li>
<li><code>LAZY_PUSH (0x06)</code>: This is sent out at every round to random neighbors for each active rumor in its store. The payload contains the hash of the raw message intended to be gossiped.</li>
<li><code>LAZY_PULL (0x07)</code>: The response to the sender if it is the first time that sender has sent a <code>LAZY_PUSH</code>/<code>EMPTY_PUSH</code> message during this round. The payload contains the hash of the raw message.</li>
</ul>
<blockquote>
<p><strong>NOTE:</strong> Every gossip message is signed, and the signature is verified before being accepted.</p>
</blockquote>
<p>Through the messages above, the standard Push-Pull mechanism is optimized by gossiping the hashes using <code>EMPTY_*</code> and <code>LAZY_*</code> and fetching the actual raw messages using <code>PUSH</code> and <code>PULL</code>.</p>
<p>So, <code>LAZY_PUSH</code> and <code>LAZY_PULL</code> are the backbone for gossiping of hashes, and are the only gossip messages that have a valid <code>GOSSIP_ROUND</code> for their underlying rumor (i.e., the hash). For the other message types, <code>GOSSIP_ROUND</code> is just set to -1 since it has no use in these types.</p>
<h3><a class="anchor" aria-hidden="true" id="message-subscription"></a><a href="#message-subscription" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Message Subscription</h3>
<p>Due to the nature of quick gossip, it's possible that a node might have just the hash and not the raw message yet at a particular point in time. In such cases, if the node receives a <code>PULL</code> message for that hash, it adds that node to a subscription list. As soon as the node receives the raw message for that hash, it then sends it out to all the peers in the subscription list.</p>
<h2><a class="anchor" aria-hidden="true" id="tree-based-cluster-broadcasting"></a><a href="#tree-based-cluster-broadcasting" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Tree-Based Cluster Broadcasting</h2>
<p>Gossip is used widely in the Zilliqa network for messaging. However, the gossip protocol by design needs the information of all peers that must eventually receive the rumor.</p>
<p>This basic requirement for peer information is usually available to a node, except at the point when a new DS block has been mined. The DS block contains the peer information for all shards, which is extracted by each node to initialize its peer list and restart the gossip engine.</p>
<p>However, distributing the DS block itself is a problem that has to be dealt with in a different manner. The solution employed is tree-based cluster broadcasting. At the start of a new DS epoch, before DS block distribution, shard nodes don't know the information of the other nodes in the same shard.
Thus, we leverage clustered multicasting in order to broadcast the DS block to all the nodes within a shard.</p>
<h3><a class="anchor" aria-hidden="true" id="design"></a><a href="#design" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Design</h3>
<ol>
<li>Assume that we have <code>X</code> nodes in a shard. We form clusters - each of <code>Y</code> nodes - out of these shard nodes. Each cluster, in turn, has <code>Z</code> child clusters.</li>
<li>Every node is assigned a sequence number <code>n</code> starting from <code>0</code>, such that <code>n/Y</code> represents the cluster it belongs to. For example, <code>2/10 = 0</code>, <code>11/10 = 1</code>.</li>
<li>Therefore, we should have a total of <code>X/Y</code> clusters, indexed from <code>0</code> to <code>X/Y-1</code>. A node <code>n</code> belonging to cluster <code>n/Y</code> is at level <code>log_Z(n/Y)</code>.</li>
<li>A node multicasts messages to nodes within the range <code>(n/Y * Z + 1)*Y</code> ~ <code>((n/Y * Z + Z + 1)* Y - 1)</code>. Bound checks on node index need to be done before multicasting. If the checks fail, we don’t broadcast.</li>
</ol>
<p><img src="../assets/core/features/tree-based-cluster-broadcasting/image01.jpg" alt="image01"></p>
<h3><a class="anchor" aria-hidden="true" id="application"></a><a href="#application" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Application</h3>
<p>These are the parameters that control the broadcasting of DS blocks from DS committee nodes to shard nodes according to the design above.</p>
<pre><code class="hljs css language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">data_sharing</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">BROADCAST_TREEBASED_CLUSTER_MODE</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">BROADCAST_TREEBASED_CLUSTER_MODE</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">NUM_FORWARDED_BLOCK_RECEIVERS_PER_SHARD</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">NUM_FORWARDED_BLOCK_RECEIVERS_PER_SHARD</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">MULTICAST_CLUSTER_SIZE</span>&gt;</span>10<span class="hljs-tag">&lt;/<span class="hljs-name">MULTICAST_CLUSTER_SIZE</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">NUM_OF_TREEBASED_CHILD_CLUSTERS</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">NUM_OF_TREEBASED_CHILD_CLUSTERS</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">data_sharing</span>&gt;</span>
</code></pre>
<ul>
<li><code>BROADCAST_TREEBASED_CLUSTER_MODE</code>: Toggles between tree-based cluster broadcasting or pure multicasting.</li>
<li><code>NUM_FORWARDED_BLOCK_RECEIVERS_PER_SHARD</code>: The number of shard nodes to initially receive the DS block from DS committee nodes.</li>
<li><code>MULTICAST_CLUSTER_SIZE</code>: The number of nodes in each cluster.</li>
<li><code>NUM_OF_TREEBASED_CHILD_CLUSTERS</code>: The number of child clusters for a given cluster.</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="blacklist"></a><a href="#blacklist" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Blacklist</h2>
<p>Zilliqa has a blacklisting feature implemented in <code>libNetwork</code>. The idea is to keep track of IP addresses of peers that, for conditions listed below, can potentially disrupt the operation of the node. Once blacklisted, the peer is effectively excluded from further interactions with the node.</p>
<h3><a class="anchor" aria-hidden="true" id="blacklisting-conditions"></a><a href="#blacklisting-conditions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Blacklisting Conditions</h3>
<ul>
<li>Socket write failure (according to <code>P2PComm::IsHostHavingNetworkIssue</code>)</li>
<li>Socket connect failure (according to <code>P2PComm::IsHostHavingNetworkIssue</code>)</li>
<li>Gossip message from peer exceeds <code>MAX_GOSSIP_MSG_SIZE_IN_BYTES</code></li>
<li>Bytes read from peer exceeds <code>MAX_READ_WATERMARK_IN_BYTES</code></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="blacklist-checking"></a><a href="#blacklist-checking" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Blacklist Checking</h3>
<p>Outgoing</p>
<ul>
<li><code>Lookup::SendMessageToRandomSeedNode</code></li>
<li><code>P2PComm::SendMessageNoQueue</code></li>
<li><code>SendJob::SendMessageCore</code></li>
<li><code>SendJobPeer::DoSend</code></li>
<li><code>SendJobPeers&lt;T&gt;::DoSend</code></li>
</ul>
<p>Incoming</p>
<ul>
<li><code>P2PComm::AcceptConnectionCallback</code></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="blacklist-exemptions"></a><a href="#blacklist-exemptions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Blacklist Exemptions</h3>
<p>Adding exclusion privilege</p>
<ol>
<li>DS guards
<ul>
<li>When <code>NEWDSGUARDNETWORKINFO</code> is received (new IP)</li>
<li>Whenever DS committee is updated</li>
</ul></li>
<li>Lookup nodes
<ul>
<li>Every time a message is sent out</li>
</ul></li>
<li>Manual addition of an IP using <code>miner_info.py whitelist_add</code></li>
</ol>
<p>Removing exclusion privilege</p>
<ol>
<li>DS guards
<ul>
<li>When <code>NEWDSGUARDNETWORKINFO</code> is received (old IP)</li>
</ul></li>
<li>Manual removal of an IP using <code>miner_info.py whitelist_remove</code></li>
</ol>
<h3><a class="anchor" aria-hidden="true" id="blacklist-removal-and-clearing"></a><a href="#blacklist-removal-and-clearing" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Blacklist Removal and Clearing</h3>
<ul>
<li>Non-lookup nodes remove <code>BLACKLIST_NUM_TO_POP</code> number of peers from the blacklist at the start of the DS epoch</li>
<li>Non-lookup nodes also remove all blacklisted seed nodes from the blacklist at the start of the DS epoch</li>
<li>Lookup nodes clear the entire blacklist upon receiving the DS Block</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="blacklist-enabling"></a><a href="#blacklist-enabling" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Blacklist Enabling</h3>
<p>Blacklist is enabled by default, and is only temporarily disabled when doing node recovery (<code>RECOVERY_ALL_SYNC</code>). In that situation, the blacklist is re-enabled once the final block is processed.</p>
<h2><a class="anchor" aria-hidden="true" id="messaging-limits"></a><a href="#messaging-limits" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Messaging Limits</h2>
<p>The volume and size of peer-to-peer communication for a Zilliqa node is controlled by several factors at different parts of the stack.</p>
<h3><a class="anchor" aria-hidden="true" id="message-size"></a><a href="#message-size" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Message Size</h3>
<ul>
<li><code>MIN_READ_WATERMARK_IN_BYTES</code>: The minimum number of bytes read from the socket before we act on the data. It is basically the <code>lowmark</code> parameter required by the libevent function <code>bufferevent_setwatermark</code>.</li>
<li><code>MAX_READ_WATERMARK_IN_BYTES</code>: The maximum number of bytes read from the socket before we stop accepting further input. It is basically the <code>highmark</code> parameter required by the libevent function <code>bufferevent_setwatermark</code>.</li>
<li><code>MAX_GOSSIP_MSG_SIZE_IN_BYTES</code>: The maximum size of a socket message with start byte = <code>START_BYTE_GOSSIP</code>. If a message reaches this size, the sender is blacklisted.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="message-count"></a><a href="#message-count" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Message Count</h3>
<ul>
<li><code>MAXSENDMESSAGE</code>: The number of active threads for the outgoing message pool.</li>
<li><code>MAXRECVMESSAGE</code>: The number of active threads for the incoming message pool.</li>
<li><code>SENDQUEUE_SIZE</code>: The maximum size of the outgoing message queue (before transfer to the outgoing pool), beyond which any further messages are dropped.</li>
<li><code>MSGQUEUE_SIZE</code>: The maximum size of the incoming message queue (before transfer to the incoming pool), beyond which any further messages are dropped.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="sending-frequency"></a><a href="#sending-frequency" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sending Frequency</h3>
<ul>
<li><code>MAXRETRYCONN</code>: The maximum number of socket connection attempts to perform for sending messages to a peer.</li>
<li><code>PUMPMESSAGE_MILLISECONDS</code>: The maximum wait time (minimum being 1 ms) before re-attempting socket connection.</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="active-connections"></a><a href="#active-connections" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Active Connections</h3>
<ul>
<li><code>MAX_PEER_CONNECTION</code>: The maximum number of active connections to a specific peer.</li>
</ul>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/dev-portal/docs/en/core-consensus"><span class="arrow-prev">← </span><span>Consensus Layer</span></a><a class="docs-next button" href="/dev-portal/docs/en/core-messaging"><span>Messaging Layer</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#gossip-protocol">Gossip Protocol</a><ul class="toc-headings"><li><a href="#overview">Overview</a></li><li><a href="#interfaces">Interfaces</a></li><li><a href="#rumor-state-machine">Rumor State Machine</a></li><li><a href="#gossip-message-format">Gossip Message Format</a></li><li><a href="#optimized-pull-push-mechanism">Optimized Pull-Push Mechanism</a></li><li><a href="#message-subscription">Message Subscription</a></li></ul></li><li><a href="#tree-based-cluster-broadcasting">Tree-Based Cluster Broadcasting</a><ul class="toc-headings"><li><a href="#design">Design</a></li><li><a href="#application">Application</a></li></ul></li><li><a href="#blacklist">Blacklist</a><ul class="toc-headings"><li><a href="#blacklisting-conditions">Blacklisting Conditions</a></li><li><a href="#blacklist-checking">Blacklist Checking</a></li><li><a href="#blacklist-exemptions">Blacklist Exemptions</a></li><li><a href="#blacklist-removal-and-clearing">Blacklist Removal and Clearing</a></li><li><a href="#blacklist-enabling">Blacklist Enabling</a></li></ul></li><li><a href="#messaging-limits">Messaging Limits</a><ul class="toc-headings"><li><a href="#message-size">Message Size</a></li><li><a href="#message-count">Message Count</a></li><li><a href="#sending-frequency">Sending Frequency</a></li><li><a href="#active-connections">Active Connections</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/dev-portal/" class="nav-home"><img src="/dev-portal/img/zilliqa-logo_1zilliqa-logo.png" alt="Zilliqa Developer Portal" width="66" height="70"/></a><div><h5>Links</h5><a href="https://www.github.com/Zilliqa" target="_blank" rel="noreferrer noopener">GitHub</a><a href="https://blog.zilliqa.com/" target="_blank" rel="noreferrer noopener">Medium</a><a href="https://twitter.com/zilliqa" target="_blank" rel="noreferrer noopener">Twitter</a><a href="https://discord.gg/XMRE9tt" target="_blank" rel="noreferrer noopener">Discord</a><a href="https://www.youtube.com/channel/UCvinnFbf0u71cajoxKcfZIQ" target="_blank" rel="noreferrer noopener">YouTube</a></div></section><section class="copyright">Copyright © 2020 Zilliqa Research Pte. Ltd.</section></footer></div></body></html>