<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Websocket Server · Zilliqa Developer Portal</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="This page describes the protocol, between the Zilliqa Websocket Server and the sdk client, for querying subscription and message pushing."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Websocket Server · Zilliqa Developer Portal"/><meta property="og:type" content="website"/><meta property="og:url" content="https://ansnunez.github.io/dev-portal/"/><meta property="og:description" content="This page describes the protocol, between the Zilliqa Websocket Server and the sdk client, for querying subscription and message pushing."/><meta property="og:image" content="https://ansnunez.github.io/dev-portal/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://ansnunez.github.io/dev-portal/img/docusaurus.png"/><link rel="shortcut icon" href="/dev-portal/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/dev-portal/js/scrollSpy.js"></script><link rel="stylesheet" href="/dev-portal/css/main.css"/><script src="/dev-portal/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/dev-portal/en"><img class="logo" src="/dev-portal/img/zilliqa-logo_1zilliqa-logo.png" alt="Zilliqa Developer Portal"/><h2 class="headerTitleWithLogo">Zilliqa Developer Portal</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/dev-portal/docs/en/basics-intro-blockchain" target="_self">Basics</a></li><li class=""><a href="/dev-portal/docs/en/dev-started-introduction" target="_self">Developers</a></li><li class=""><a href="/dev-portal/docs/en/mining-general-info" target="_self">Miners</a></li><li class=""><a href="/dev-portal/docs/en/staking-getting-started" target="_self">Exchanges</a></li><li class="siteNavGroupActive"><a href="/dev-portal/docs/en/contribute-buildzil" target="_self">Contributors</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/dev-portal/img/language.svg" alt="Languages icon"/>English</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/dev-portal/docs/zh-CN/core-websocket-server">中文</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Core Protocol Design</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Contributors</h3><ul class=""><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Contribution Guide</h4><ul><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/contribute-buildzil">Building Zilliqa</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/contribute-guidelines">Contribution Guidelines</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/contribute-bug-bounty">Bug Bounty Program</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Core Protocol Design</h4><ul><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-intro">Introduction</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-consensus">Consensus</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-schnorr">Schnorr Algorithm</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-multisignatures">Multisignatures</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-gossip">Gossip</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-broadcasting">Broadcasting</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-blacklist">Blacklist</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-messaging-limits">Messaging Limits</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-message-processing">Message Processing</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-data">Data Layer</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-ds-mimo">DS MIMO</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-ds-reputation">DS Reputation</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-api-server">API Server</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/dev-portal/docs/en/core-websocket-server">Websocket Server</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-transaction-dispatch">Transaction Dispatch</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-multipliers">Multipliers</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-incremental-db">Incremental DB</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-pow">PoW Algorithm</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-difficulty-adjustment">Difficulty Adjustment</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-por">Proof of Reputation</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-coinbase">Coinbase Rewards</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-diagnostic-data">Diagnostic Data</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-view-change">View Change</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-guard-mode">Guard Mode</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-rejoin-mechanism">Rejoin Mechanism</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-recovery-mechanism">Recovery Mechanism</a></li><li class="navListItem"><a class="navItem" href="/dev-portal/docs/en/core-status-server">Status Server</a></li></ul></div></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Websocket Server</h1></header><article><div><span><p>This page describes the protocol, between the Zilliqa Websocket Server and the sdk client, for querying subscription and message pushing.</p>
<h2><a class="anchor" aria-hidden="true" id="feature-workflow"></a><a href="#feature-workflow" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Feature workflow</h2>
<p>Client can subscribe their interested topics or unsubscribe certain topic by sending query, if the query failed they will normally be informed immediately with related error message. For every Tx block(epoch), the subscribed content will be sent from server to each client in one message where an array contains all their subscribed topic if updated, which we name <strong>notification</strong>.</p>
<h2><a class="anchor" aria-hidden="true" id="supported-query"></a><a href="#supported-query" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Supported query</h2>
<p>The following types of data are the current main focus that we want to consider to be supported by ZWS:</p>
<ul>
<li><strong>New TxBlock</strong>. Which includes TxBlock recently generated and hashes of all the transaction being processed within this block.</li>
<li><strong>Event log</strong>. Which includes all the event log generated for interested contract address</li>
<li><strong>Unsubscribe</strong>. Which tells the server to unsubscribe certain topic for the client</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="exception-handling"></a><a href="#exception-handling" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exception handling</h2>
<p>Usually an <strong>error message</strong> will be responded to the client if the query failed, it may looks like</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"type"</span>:<span class="hljs-string">"Error"</span>,
  <span class="hljs-attr">"error"</span>:<span class="hljs-string">"..."</span>
}
</code></pre>
<p>The following error messages will be applied to all kinds of query if being invalid:</p>
<ul>
<li><strong>invalid query field</strong>. Which tells the client if the query is invalid, it could be not found, empty, malformed, or not available</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="message-encoding"></a><a href="#message-encoding" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Message encoding</h2>
<p>For convention, we still use JSON as our encoding format.</p>
<p>The epoch message will be presented in this way:</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"type"</span>:<span class="hljs-string">"notification"</span>,
  <span class="hljs-attr">"values"</span>:[
    {
      <span class="hljs-attr">"query"</span>:<span class="hljs-string">"..."</span>,
      <span class="hljs-attr">"value"</span>:<span class="hljs-string">"..."</span>
    },
    {
      <span class="hljs-attr">"query"</span>:<span class="hljs-string">"..."</span>,
      <span class="hljs-attr">"value"</span>:<span class="hljs-string">"..."</span>
    }
  ]
}
</code></pre>
<p>The followings are case by case for each subscription:</p>
<h3><a class="anchor" aria-hidden="true" id="subscribe-new-block"></a><a href="#subscribe-new-block" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Subscribe New Block</h3>
<h4><a class="anchor" aria-hidden="true" id="query-message"></a><a href="#query-message" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>query message</h4>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"query"</span>:<span class="hljs-string">"NewBlock"</span>,
}
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="response-message"></a><a href="#response-message" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>response message</h4>
<p>Once succsfully subscribed, server will echo the query message to the client, otherwise will return error message.</p>
<p>Special error message:</p>
<ul>
<li><strong>NA</strong>`</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="expected-field-in-notification"></a><a href="#expected-field-in-notification" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>expected field in notification</h4>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"query"</span>:<span class="hljs-string">"NewBlock"</span>,
  <span class="hljs-attr">"value"</span>:{
    <span class="hljs-attr">"TxBlock"</span>:{
      <span class="hljs-comment">// same as the json object by quering jsonrpc for `GetTxBlock`</span>
    },
    <span class="hljs-attr">"TxHashes"</span>:[
      <span class="hljs-comment">// same as the json object by querying jsonrpc for `GetTransactionsForTxBlock`</span>
    ]
  }
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="subscribe-event-log"></a><a href="#subscribe-event-log" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Subscribe Event Log</h3>
<h4><a class="anchor" aria-hidden="true" id="query-message-1"></a><a href="#query-message-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>query message</h4>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"query"</span>:<span class="hljs-string">"EventLog"</span>,
  <span class="hljs-attr">"addresses"</span>:[
    <span class="hljs-string">"0x0000000000000000000000000000000000000000"</span>,
    <span class="hljs-string">"0x1111111111111111111111111111111111111111"</span>
  ]
}
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="response-message-1"></a><a href="#response-message-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>response message</h4>
<p>Once succesfully subscribed, server will echo the query message to the client,
otherwise will return error message.</p>
<p>Special error message:</p>
<ul>
<li><strong>invalid addresses field</strong>, which tells the client the addresses field is invalid, it could either be not found, malformed or empty</li>
<li><strong>no contract found in list</strong>, which tells the client the addresses provided are all of non contract</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="expected-field-in-notification-1"></a><a href="#expected-field-in-notification-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>expected field in notification</h4>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"query"</span>:<span class="hljs-string">"EventLog"</span>,
  <span class="hljs-attr">"value"</span>:
  [
    {
      <span class="hljs-attr">"address"</span>:<span class="hljs-string">"0x0000000000000000000000000000000000000000"</span>,
      <span class="hljs-attr">"event_logs"</span>:[
        {
          <span class="hljs-attr">"_eventname"</span>:<span class="hljs-string">"foo1"</span>,
          <span class="hljs-attr">"params"</span>:[
            {
              <span class="hljs-attr">"vname"</span>:<span class="hljs-string">"bar1"</span>,
              <span class="hljs-attr">"type"</span>:<span class="hljs-string">"String"</span>,
              <span class="hljs-attr">"value"</span>:<span class="hljs-string">"abc"</span>
            },
            {
              <span class="hljs-attr">"vname"</span>:<span class="hljs-string">"bar2"</span>,
              <span class="hljs-attr">"type"</span>:<span class="hljs-string">"ByStr32"</span>,
              <span class="hljs-attr">"value"</span>:<span class="hljs-string">"0x0000000000000000000000000000000000000001"</span>
            }
          ]
        },
      ]
    }
  ]
}
</code></pre>
<p>Notice that for address <code>0x1111111111111111111111111111111111111111</code> is not presented in the message since it doesn't have any event log released in this epoch.</p>
<h3><a class="anchor" aria-hidden="true" id="unsubscribe"></a><a href="#unsubscribe" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Unsubscribe</h3>
<h4><a class="anchor" aria-hidden="true" id="query-message-2"></a><a href="#query-message-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>query message</h4>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"query"</span>:<span class="hljs-string">"Unsubscribe"</span>,
  <span class="hljs-attr">"type"</span>:<span class="hljs-string">"EventLog"</span>
}
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="response-message-2"></a><a href="#response-message-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>response message</h4>
<p>Once succesfully ubsubscribed, server will echo the query message to the client,
otherwise will return error message.</p>
<p>Special error message:</p>
<ul>
<li><strong>invalid type field</strong>, which tells the client the type field is invalid, if could either be not found, malformed or not available.</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="expected-field-in-notification-2"></a><a href="#expected-field-in-notification-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>expected field in notification</h4>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"query"</span>:<span class="hljs-string">"Unsubscribe"</span>,
  <span class="hljs-attr">"value"</span>:[<span class="hljs-string">"NewBlock"</span>, <span class="hljs-string">"EventLog"</span>]
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="example"></a><a href="#example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h2>
<p>Client subscribe NewBlock:</p>
<pre><code class="hljs css language-json">{
 <span class="hljs-attr">"query"</span>:<span class="hljs-string">"NewBlock"</span>
}
</code></pre>
<p>Client subscribe EventLog:</p>
<pre><code class="hljs css language-json">{
 <span class="hljs-attr">"query"</span>:<span class="hljs-string">"EventLog"</span>,
 <span class="hljs-attr">"addresses"</span>:[
   <span class="hljs-string">"0x000000000000000000000000000000000"</span>,
   <span class="hljs-string">"0x111111111111111111111111111111111"</span>
 ]
}
</code></pre>
<p>Client unsubscribe NewBlock:</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"query"</span>:<span class="hljs-string">"Unsubscribe"</span>,
  <span class="hljs-attr">"type"</span>:<span class="hljs-string">"NewBlock"</span>
}
</code></pre>
<p>Notification:</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"type"</span>:<span class="hljs-string">"notification"</span>,
  <span class="hljs-attr">"values"</span>:[
    {
      <span class="hljs-attr">"query"</span>:<span class="hljs-string">"NewBlock"</span>,
      <span class="hljs-attr">"value"</span>:{
        <span class="hljs-attr">"TxBlock"</span>:{
          <span class="hljs-attr">"body"</span>:{
            <span class="hljs-attr">"BlockHash"</span>:<span class="hljs-string">"b2214da8e25efbd4291f85016094824a8fcd46075d06e365282d39ee4ba8ca24"</span>,
            <span class="hljs-attr">"HeaderSign"</span>:<span class="hljs-string">"E276EFC8B01AC51804272AAAB4FC59DD96B08B3988F9DA6BED28657CC74A1A609E73B203AA58664EAEB4A960FFEF3D636A7691EBD7F89A03CEFEB12FA8797615"</span>,
            <span class="hljs-attr">"MicroBlockInfos"</span>:[
              {
                <span class="hljs-attr">"MicroBlockHash"</span>:<span class="hljs-string">"9e811581454211ea5a757678460bb62a73860d1be9e5b8b805d3b176d4d92451"</span>,
                <span class="hljs-attr">"MicroBlockShardId"</span>:<span class="hljs-number">0</span>,
                <span class="hljs-attr">"MicroBlockTxnRootHash"</span>:<span class="hljs-string">"eec45db6a9b70463a8ac32bec853bcb5fe1d73ffec1244e1cc0427036483bbfa"</span>
              },
              {
                <span class="hljs-attr">"MicroBlockHash"</span>:<span class="hljs-string">"066ff187ff392a9a9cd430a248552f10759f98e0ac530015091ffa430d68ba83"</span>,
                <span class="hljs-attr">"MicroBlockShardId"</span>:<span class="hljs-number">1</span>,
                <span class="hljs-attr">"MicroBlockTxnRootHash"</span>:<span class="hljs-string">"0000000000000000000000000000000000000000000000000000000000000000"</span>
              },
              {
                <span class="hljs-attr">"MicroBlockHash"</span>:<span class="hljs-string">"250091b5c626143bde230813c527f77a007303e6dc3502642c7d468bc2d064e4"</span>,
                <span class="hljs-attr">"MicroBlockShardId"</span>:<span class="hljs-number">2</span>,
                <span class="hljs-attr">"MicroBlockTxnRootHash"</span>:<span class="hljs-string">"0000000000000000000000000000000000000000000000000000000000000000"</span>
              }
            ]
          },
          <span class="hljs-attr">"header"</span>:{
            <span class="hljs-attr">"BlockNum"</span>:<span class="hljs-string">"15"</span>,
            <span class="hljs-attr">"DSBlockNum"</span>:<span class="hljs-string">"1"</span>,
            <span class="hljs-attr">"GasLimit"</span>:<span class="hljs-string">"15000000"</span>,
            <span class="hljs-attr">"GasUsed"</span>:<span class="hljs-string">"1"</span>,
            <span class="hljs-attr">"MbInfoHash"</span>:<span class="hljs-string">"4b2d20a0bcb382ad2e2560791ed90ed21100e8e84ebac63d62d3c0b1a3fb11fe"</span>,
            <span class="hljs-attr">"MinerPubKey"</span>:<span class="hljs-string">"0x02FC9ED69524A23AEFCB85B8A36C998F512C0512C6932DED74680A044F9D3EBC95"</span>,
            <span class="hljs-attr">"NumMicroBlocks"</span>:<span class="hljs-number">3</span>,
            <span class="hljs-attr">"NumTxns"</span>:<span class="hljs-number">1</span>,
            <span class="hljs-attr">"PrevBlockHash"</span>:<span class="hljs-string">"5bda21605e7ea9404c58a40eebe99563adf330bab5b39e7438f8e4db28607b37"</span>,
            <span class="hljs-attr">"Rewards"</span>:<span class="hljs-string">"1000000000"</span>,
            <span class="hljs-attr">"StateDeltaHash"</span>:<span class="hljs-string">"2f878030ab9b0a211c1e584e140707c79d62d067390bfe3ccaf08fdaeaad2229"</span>,
            <span class="hljs-attr">"StateRootHash"</span>:<span class="hljs-string">"94abb63e27984f46e914db2601de6af2048a3bf72f69eaac34421b7dfbd34a82"</span>,
            <span class="hljs-attr">"Timestamp"</span>:<span class="hljs-string">"1572512230807870"</span>,
            <span class="hljs-attr">"Version"</span>:<span class="hljs-number">1</span>
          }
        }
      },
      <span class="hljs-attr">"TxHashes"</span>:[
        [<span class="hljs-string">"1beb32a5435e993aa3025a70d8a5e71df43c10e2fe3f6ef832d1a5c371a63852"</span>],
        [],
        []
      ]
    },
    {
      <span class="hljs-attr">"query"</span>:<span class="hljs-string">"EventLog"</span>,
      <span class="hljs-attr">"value"</span>:[
        {
          <span class="hljs-attr">"address"</span>:<span class="hljs-string">"0x0000000000000000000000000000000000000000"</span>,
          <span class="hljs-attr">"event_logs"</span>:[
            {
              <span class="hljs-attr">"_eventname"</span>:<span class="hljs-string">"foo1"</span>,
              <span class="hljs-attr">"params"</span>:[
                {
                  <span class="hljs-attr">"vname"</span>:<span class="hljs-string">"bar1"</span>,
                  <span class="hljs-attr">"type"</span>:<span class="hljs-string">"String"</span>,
                  <span class="hljs-attr">"value"</span>:<span class="hljs-string">"abc"</span>
                },
                {
                  <span class="hljs-attr">"vname"</span>:<span class="hljs-string">"bar2"</span>,
                  <span class="hljs-attr">"type"</span>:<span class="hljs-string">"ByStr32"</span>,
                  <span class="hljs-attr">"value"</span>:<span class="hljs-string">"0x0000000000000000000000000000000000000001"</span>
                }
              ]
            }
          ]
        }
      ]
    },
    {
      <span class="hljs-attr">"query"</span>:<span class="hljs-string">"Unsubscribe"</span>,
      <span class="hljs-attr">"value"</span>:[<span class="hljs-string">"NewBlock"</span>]
    }
  ]
}

</code></pre>
<p>And in the next tx block, the client won't be receiving <code>NewBlock</code> in notification</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/dev-portal/docs/en/core-api-server"><span class="arrow-prev">← </span><span>API Server</span></a><a class="docs-next button" href="/dev-portal/docs/en/core-transaction-dispatch"><span>Transaction Dispatch</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#feature-workflow">Feature workflow</a></li><li><a href="#supported-query">Supported query</a></li><li><a href="#exception-handling">Exception handling</a></li><li><a href="#message-encoding">Message encoding</a><ul class="toc-headings"><li><a href="#subscribe-new-block">Subscribe New Block</a></li><li><a href="#subscribe-event-log">Subscribe Event Log</a></li><li><a href="#unsubscribe">Unsubscribe</a></li></ul></li><li><a href="#example">Example</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/dev-portal/" class="nav-home"><img src="/dev-portal/img/zilliqa-logo_1zilliqa-logo.png" alt="Zilliqa Developer Portal" width="66" height="70"/></a><div><h5>Links</h5><a href="https://www.github.com/Zilliqa" target="_blank" rel="noreferrer noopener">GitHub</a><a href="https://blog.zilliqa.com/" target="_blank" rel="noreferrer noopener">Medium</a><a href="https://twitter.com/zilliqa" target="_blank" rel="noreferrer noopener">Twitter</a><a href="https://discord.gg/XMRE9tt" target="_blank" rel="noreferrer noopener">Discord</a><a href="https://www.youtube.com/channel/UCvinnFbf0u71cajoxKcfZIQ" target="_blank" rel="noreferrer noopener">YouTube</a></div></section><section class="copyright">Copyright © 2020 Zilliqa Research Pte. Ltd.</section></footer></div></body></html>