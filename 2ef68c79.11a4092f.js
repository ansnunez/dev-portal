(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{157:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return s}));var a=n(2),o=n(9),i=(n(0),n(237)),r={id:"staking-getting-started",title:"Setting up the SSN"},l={id:"staking-getting-started",isDocsHomePage:!1,title:"Setting up the SSN",description:"IP whitelisting and API servicing",source:"@site/docs/staking-getting-started.md",permalink:"/docs/staking-getting-started",editUrl:"https://github.com/Zilliqa/dev-portal/docs/staking-getting-started.md",sidebar:"someSidebar4",previous:{title:"General information",permalink:"/docs/staking-introduction"},next:{title:"Smart contract operations",permalink:"/docs/staking-ssn-operations"}},c=[{value:"Launching the node using Docker",id:"launching-the-node-using-docker",children:[]},{value:"Launching the node using native build",id:"launching-the-node-using-native-build",children:[]},{value:"Optional: Configuring domain name",id:"optional-configuring-domain-name",children:[]},{value:"Testing your staked seed node JSON-RPC port",id:"testing-your-staked-seed-node-json-rpc-port",children:[]},{value:"Testing your staked seed node WebSocket port",id:"testing-your-staked-seed-node-websocket-port",children:[]}],b={rightToc:c};function s(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h1",{id:"ip-whitelisting-and-api-servicing"},"IP whitelisting and API servicing"),Object(i.b)("p",null,"It is necessary for the staked seed node to be whitelisted by Zilliqa in phase 0 in order to receive data broadcasts about the blockchain and its state. This requires a static public IP address with minimal the following inbound and outbound port open."),Object(i.b)("table",null,Object(i.b)("thead",{parentName:"table"},Object(i.b)("tr",{parentName:"thead"},Object(i.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Type"),Object(i.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Default"),Object(i.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Purpose"))),Object(i.b)("tbody",{parentName:"table"},Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Inbound"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"33133"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Protocol level port for receiving network data")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Inbound"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"4201/443"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(i.b)("a",Object(a.a)({parentName:"td"},{href:"https://apidocs.zilliqa.com/#introduction"}),"API service"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Inbound"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"4401"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(i.b)("a",Object(a.a)({parentName:"td"},{href:"api-websocket"}),"Websocket servuce"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Inbound"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"4501"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Staking API service")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"Outbound"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"443"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"For getting intiial node data for syncing")))),Object(i.b)("h1",{id:"preparing-the-node"},"Preparing the node"),Object(i.b)("p",null,"Launching a seed node for staking is similar to launching a normal seed node, with some additional configuration steps."),Object(i.b)("p",null,"In this guide, we will demonstrate on how to set up the seed node via"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"#launching-the-node-using-docker"}),"Docker")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"#launching-the-node-using-native-build"}),"Native build"))),Object(i.b)("p",null,"You can go for either one of the options above."),Object(i.b)("h2",{id:"launching-the-node-using-docker"},"Launching the node using Docker"),Object(i.b)("p",null,"We highly recommend using ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://docker.com/"}),"Docker")," to set up a seed node, as we provide a tested, production-ready image for your use. If you have not yet set up docker, please follow the instructions on the ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.docker.com/install/"}),"official documentation"),"."),Object(i.b)("p",null,"Once you have set up Docker, you may proceed to download and uncompress the configuration tarball for the mainnet:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"# create a directory\n$ mkdir my_seed && cd my_seed\n\n# download and extract the seed node configuration files\n$ wget https://testnet-join.zilliqa.com/seed-configuration.tar.gz\n$ tar -zxvf seed-configuration.tar.gz\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"# create a directory\n$ mkdir my_seed && cd my_seed\n\n# download and extract the seed node configuration files\n$ wget https://mainnet-join.zilliqa.com/seed-configuration.tar.gz\n$ tar -zxvf seed-configuration.tar.gz\n")),Object(i.b)("p",null,"The seed node requires some configuring before it can successfully join the network and be used for staking. Most configuration is contained in ",Object(i.b)("inlineCode",{parentName:"p"},"constants.xml"),", which should be in the directory we extracted seed-configuration.tar.gz to. Minimally, the following changes are required:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Change the value of ",Object(i.b)("inlineCode",{parentName:"li"},"ENABLE_STAKING_RPC")," to ",Object(i.b)("inlineCode",{parentName:"li"},"true")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"Optional:")," Change the value of ",Object(i.b)("inlineCode",{parentName:"li"},"SEED_PORT")," to ",Object(i.b)("inlineCode",{parentName:"li"},"33133")," (default), or a port of your choice. If you do not select ",Object(i.b)("inlineCode",{parentName:"li"},"33133"),", be sure to note this down for the subsequent whitelisting step.",Object(i.b)("blockquote",{parentName:"li"},Object(i.b)("p",{parentName:"blockquote"},Object(i.b)("strong",{parentName:"p"},"Note:")," If you have used a port other than 33133, please notify us immediately so that we can adjust our whitelisted port for you."))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"Optional:")," Change the value of ",Object(i.b)("inlineCode",{parentName:"li"},"ENABLE_WEBSOCKET")," to ",Object(i.b)("inlineCode",{parentName:"li"},"true")," if your seed node will support websockets (refer to the ",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/Zilliqa/dev-portal/tree/master/docs/api-websocket.md"}),"Zilliqa Websocket Server")," documentation).")),Object(i.b)("p",null,"Finally, launch the seed node:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"$ ./launch_docker.sh\n")),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},Object(i.b)("strong",{parentName:"p"},"Note:")," A seed node needs a key pair to communicate with other nodes in the network. launch_docker.sh will automatically generate and use a key pair stored in the file mykey.txt in the same folder.")),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"}," ",Object(i.b)("strong",{parentName:"p"},"\u26a0\ufe0f")," We highly recommend to use another keypair for depositing stake, withdrawing stake and withdrawing reward.")),Object(i.b)("h2",{id:"launching-the-node-using-native-build"},"Launching the node using native build"),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},Object(i.b)("strong",{parentName:"p"},"Note:")," This approach has only been tested on ",Object(i.b)("inlineCode",{parentName:"p"},"Ubuntu 16.04.6 LTS")," and involves compiling and building the ",Object(i.b)("inlineCode",{parentName:"p"},"C++")," codebase from scratch. We strongly recommend you consider launching the node using the Docker steps detailed in the previous section.")),Object(i.b)("p",null,"If you cannot or do not wish to use Docker, you may also build the Zilliqa binary from the source and run it as such."),Object(i.b)("p",null,"First, clone the Zilliqa repository:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"# clone Zilliqa source files\n$ git clone https://github.com/Zilliqa/Zilliqa.git && cd Zilliqa && git checkout <<release tag>> && cd Zilliqa\n")),Object(i.b)("p",null,"Install system dependencies:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"$ sudo apt-get update\n$ sudo apt-get install git libboost-system-dev libboost-filesystem-dev libboost-test-dev libssl-dev libleveldb-dev libjsoncpp-dev libsnappy-dev cmake libmicrohttpd-dev libjsonrpccpp-dev build-essential pkg-config libevent-dev libminiupnpc-dev libcurl4-openssl-dev libboost-program-options-dev libboost-python-dev python3-dev python3-setuptools python3-pip gawk\n")),Object(i.b)("p",null,"Build the staked seed node:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"# Build the binary. This may take a while.\n$ ./build.sh\n")),Object(i.b)("p",null,"The build should exit with no errors. Once it is complete, download and uncompress the configuration tarball:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"# create a directory\n$ mkdir my_seed && cd my_seed\n\n# download and extract the seed node configuration files\n$ wget https://testnet-join.zilliqa.com/seed-configuration.tar.gz\n$ tar -zxvf seed-configuration.tar.gz\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"# create a directory\n$ mkdir my_seed && cd my_seed\n\n# download and extract the seed node configuration files\n$ wget https://mainnet-join.zilliqa.com/seed-configuration.tar.gz\n$ tar -zxvf seed-configuration.tar.gz\n")),Object(i.b)("p",null,"The staked seed node requires some configuring before it can successfully join the network and be used for staking. Most configuration is contained in ",Object(i.b)("inlineCode",{parentName:"p"},"constants.xml"),", which should be in the directory we extracted ",Object(i.b)("inlineCode",{parentName:"p"},"configuration.tar.gz")," to. Minimally, the following changes are required:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Change the value of ",Object(i.b)("inlineCode",{parentName:"li"},"ENABLE_STAKING_RPC")," to ",Object(i.b)("inlineCode",{parentName:"li"},"true")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"Optional:")," Change the value of ",Object(i.b)("inlineCode",{parentName:"li"},"SEED_PORT")," to ",Object(i.b)("inlineCode",{parentName:"li"},"33133")," (default), or a port of your choice. If you do not select ",Object(i.b)("inlineCode",{parentName:"li"},"33133"),", be sure to note this down for the subsequent whitelisting step.",Object(i.b)("blockquote",{parentName:"li"},Object(i.b)("p",{parentName:"blockquote"},Object(i.b)("strong",{parentName:"p"},"Note:")," If you have used a port other than 33133, please notify us immediately so that we can adjust our whitelisted port for you."))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"Note:")," Change the value of ",Object(i.b)("inlineCode",{parentName:"li"},"ENABLE_WEBSOCKET")," to ",Object(i.b)("inlineCode",{parentName:"li"},"true"),". This enables your seed node to support websockets (refer to the ",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/Zilliqa/dev-portal/tree/master/docs/api-websocket.md"}),"Zilliqa Websocket Server")," documentation).")),Object(i.b)("p",null,"Finally, launch the seed node:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"$ ./launch.sh\n")),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},Object(i.b)("strong",{parentName:"p"},"Note:")," A seed node needs a key pair to communicate with other nodes in the network. launch.sh will automatically generate and use a key pair stored in the file mykey.txt in the same folder")),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"}," ",Object(i.b)("strong",{parentName:"p"},"\u26a0\ufe0f")," We highly recommend to use another keypair for depositing stake, withdrawing stake and withdrawing reward.")),Object(i.b)("h2",{id:"optional-configuring-domain-name"},"Optional: Configuring domain name"),Object(i.b)("p",null,"Once your seed node is fully set up, it is time to configure your domain name to point to the address of your seed node. "),Object(i.b)("p",null,"If your seed node is not behind a load balancer, you can set an ",Object(i.b)("inlineCode",{parentName:"p"},"A record")," in your domain registrar to point your domain/subdomain to your seed node\u2019s IP address."),Object(i.b)("p",null,"If your seed node is behind a load balancer, you can set a ",Object(i.b)("inlineCode",{parentName:"p"},"CNAME record")," in your domain registrar to point your domain/subdomain to the hostname of your load balancer."),Object(i.b)("h2",{id:"testing-your-staked-seed-node-json-rpc-port"},"Testing your staked seed node JSON-RPC port"),Object(i.b)("p",null,"To check whether your JSON-RPC is publicly available, you can use the following curl command."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'curl -d \'{\n    "id": "1",\n    "jsonrpc": "2.0",\n    "method": "GetBlockchainInfo",\n    "params": [""]\n}\' -H "Content-Type: application/json" -X POST "<staked seed node address>"\n')),Object(i.b)("p",null,"If you received the latest blockchain information (similar to the one below) from the staked seed node, your JSON-RPC service is running well."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'{"id":"1","jsonrpc":"2.0","result":{"CurrentDSEpoch":"4789","CurrentMiniEpoch":"478809","DSBlockRate":0.00013455546527607284,"NumDSBlocks":"4790","NumPeers":2400,"NumTransactions":"3091806","NumTxBlocks":"478809","NumTxnsDSEpoch":"185","NumTxnsTxEpoch":"0","ShardingStructure":{"NumPeers":[600,600,600]},"TransactionRate":0,"TxBlockRate":0.013450003515398927}}\n')),Object(i.b)("h2",{id:"testing-your-staked-seed-node-websocket-port"},"Testing your staked seed node WebSocket port"),Object(i.b)("p",null,"You can use an online websocket test utility to test whether your websocket is publicly accessible."),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Visit ",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://www.websocket.org/echo.html"}),"https://www.websocket.org/echo.html")),Object(i.b)("li",{parentName:"ol"},"Under location, put your websocket url link (e.g., ",Object(i.b)("inlineCode",{parentName:"li"},"wss://<yourdomain here or ip:port>"),")"),Object(i.b)("li",{parentName:"ol"},"Click on connect"),Object(i.b)("li",{parentName:"ol"},"If ",Object(i.b)("strong",{parentName:"li"},"\u201cCONNECTED\u201d")," is shown in the log, your websocket port is publicly accessible")))}s.isMDXComponent=!0},237:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return m}));var a=n(0),o=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var b=o.a.createContext({}),s=function(e){var t=o.a.useContext(b),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=s(e.components);return o.a.createElement(b.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},p=o.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,r=e.parentName,b=c(e,["components","mdxType","originalType","parentName"]),d=s(n),p=a,m=d["".concat(r,".").concat(p)]||d[p]||u[p]||i;return n?o.a.createElement(m,l(l({ref:t},b),{},{components:n})):o.a.createElement(m,l({ref:t},b))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,r=new Array(i);r[0]=p;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,r[1]=l;for(var b=2;b<i;b++)r[b]=n[b];return o.a.createElement.apply(null,r)}return o.a.createElement.apply(null,n)}p.displayName="MDXCreateElement"}}]);